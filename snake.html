<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #game-board {
            background-color: #000;
            width: 400px;
            height: 400px;
            position: relative;
            border: 2px solid #333;
        }
        .snake {
            background-color: #00FF00;
            position: absolute;
        }
        .food {
            background-color: #FF0000;
            position: absolute;
        }
    </style>
</head>
<body>

<div id="game-board"></div>

<script>
    // Kích thước và cấu hình của trò chơi
    const boardSize = 400;
    const snakeSize = 20;
    const board = document.getElementById('game-board');

    let snake = [{ x: 100, y: 100 }];
    let food = { x: 0, y: 0 };
    let direction = 'RIGHT';
    let score = 0;
    let gameInterval;
    
    // Hàm vẽ rắn lên màn hình
    function drawSnake() {
        board.innerHTML = ''; // Xóa tất cả các phần tử trước khi vẽ lại
        snake.forEach(segment => {
            const snakeSegment = document.createElement('div');
            snakeSegment.classList.add('snake');
            snakeSegment.style.width = `${snakeSize}px`;
            snakeSegment.style.height = `${snakeSize}px`;
            snakeSegment.style.left = `${segment.x}px`;
            snakeSegment.style.top = `${segment.y}px`;
            board.appendChild(snakeSegment);
        });
    }

    // Hàm vẽ thức ăn
    function drawFood() {
        const foodElement = document.createElement('div');
        foodElement.classList.add('food');
        foodElement.style.width = `${snakeSize}px`;
        foodElement.style.height = `${snakeSize}px`;
        foodElement.style.left = `${food.x}px`;
        foodElement.style.top = `${food.y}px`;
        board.appendChild(foodElement);
    }

    // Hàm di chuyển rắn
    function moveSnake() {
        const head = { ...snake[0] };
        switch (direction) {
            case 'UP':
                head.y -= snakeSize;
                break;
            case 'DOWN':
                head.y += snakeSize;
                break;
            case 'LEFT':
                head.x -= snakeSize;
                break;
            case 'RIGHT':
                head.x += snakeSize;
                break;
        }

        snake.unshift(head); // Thêm đầu rắn vào
        if (head.x === food.x && head.y === food.y) {
            // Rắn ăn thức ăn, tăng điểm và tạo thức ăn mới
            score++;
            document.title = `Snake Game - Score: ${score}`;
            spawnFood();
        } else {
            snake.pop(); // Xóa đuôi rắn nếu không ăn thức ăn
        }

        // Kiểm tra va chạm với bản đồ (ra ngoài màn hình hoặc đụng vào chính mình)
        if (head.x < 0 || head.x >= boardSize || head.y < 0 || head.y >= boardSize || collisionWithSelf(head)) {
            clearInterval(gameInterval);
            alert('Game Over! Your Score: ' + score);
            resetGame();
        }

        drawSnake();
        drawFood();
    }

    // Hàm kiểm tra rắn có va chạm với chính mình không
    function collisionWithSelf(head) {
        return snake.some((segment, index) => index !== 0 && segment.x === head.x && segment.y === head.y);
    }

    // Hàm tạo thức ăn ngẫu nhiên trên màn hình
    function spawnFood() {
        food.x = Math.floor(Math.random() * (boardSize / snakeSize)) * snakeSize;
        food.y = Math.floor(Math.random() * (boardSize / snakeSize)) * snakeSize;
    }

    // Hàm xử lý các phím điều khiển
    function handleKeyPress(event) {
        switch (event.key) {
            case 'ArrowUp':
                if (direction !== 'DOWN') direction = 'UP';
                break;
            case 'ArrowDown':
                if (direction !== 'UP') direction = 'DOWN';
                break;
            case 'ArrowLeft':
                if (direction !== 'RIGHT') direction = 'LEFT';
                break;
            case 'ArrowRight':
                if (direction !== 'LEFT') direction = 'RIGHT';
                break;
        }
    }

    // Hàm khởi động lại trò chơi
    function resetGame() {
        snake = [{ x: 100, y: 100 }];
        direction = 'RIGHT';
        score = 0;
        document.title = `Snake Game - Score: ${score}`;
        spawnFood();
        gameInterval = setInterval(moveSnake, 100);
    }

    // Khởi tạo trò chơi
    window.addEventListener('keydown', handleKeyPress);
    spawnFood();
    gameInterval = setInterval(moveSnake, 100);
</script>

</body>
</html>
